<!--
 * @Author: 小叶同学
 * @Date: 2024-03-23 19:49:38
 * @LastEditors: Please set LastEditors
 * @LastEditTime: 2024-03-23 19:49:43
 * @Description: 请填写简介
-->


## 前言

又到了电路小课堂时间，今天我们要聊的是 防反接电路，防反接电路是硬件工程师必备的基础知识，在网上已经有大量的防反接电路总结文章，我也查阅了大量文章。

虽然说实用的电路就那么几种，这个可谓英雄所见略同，但是大部分文章的说明部分都一样，那么这就……（不符合我的风格，不浮夸，不将就。即便是总结 ，原理可以一样，但是说明照搬那就说不过去了~ ~）

说明一下， 本文的防反接电路主要针对是单片机系统，因为博主是在智能家居领域工作的，我会结合自己的工作经验，设计的产品来说说这些电路。

## 一、二极管防反接

又是从二极管开始（和 MOS 管一样，用得这么多，我得写一篇全面认识二极管的文章了），利用 PN 结的单向导电性（不要钻牛角尖说反向漏电流）。

## 1.1 基本电路

直接在电源入口处串联一个二极管，电路简单，成本低，如下图（本图就是实际使用过的）：

![](https://static001.geekbang.org/infoq/6a/6a21b0ae30193ac8637da1fff622bf2d.png)

上图是最简单也是最常用的防反接方式，上图是二极管接在入口 Vin 端，也可以接在 GND 端，二极管反着接，是一样的效果。

### 电路分析

在单片机系统中，使用此电路 一般 一般 一般 只需要注意一个参数：最大整流电流。

首先你在设计自己电路的时候应该知道自己的负载功率，比如一般来说 STM32 最小系统，也就是 20/30 mA，加上其他的一些传感器，可以知道系统平时运行的功耗，要注意 STM32 的功耗是 3.3V 状态下的，入口电源是 5V 或者 12V，电流需要就更小了，当然不要忘记 DC/DC, 或者 LDO 的转换效率之类的。

每个二极管都有一个参数，最大整流电流，比如上图中的 SS34：

![](https://static001.geekbang.org/infoq/32/3239e130516e60221a6e85388348be1f.png)

电路设计需要冗余，所以我一般直接使用一个 SS34，基本上所有的项目都能满足要求，当然 SS34 封装稍微大一点。

网上的大部分介绍这个电路的时候都说到，二极管 0.7V 的压降，2A 电流或者更多电流的时候发热之类，我怎么看？

首先，这个说法没有错，理论上就是这么分析的！

实际应用我从以下几个点分析：二极管的选型，二极管压降与电流的关系，应用领域。

**1、二极管的选型**

上图我使用的二极管是肖特基二极管 SS34，整流电流 3A， 压降 550mV@3A（不同厂家的参数会有差异），3A 的时候最大压降 0.55V，不像大部分文章分析的 0.7V。

在这个方面所会导致的发热会下降许多。

**2、二极管压降与电流的关系**

上面说了一个参数，最大压降 550mV@3A，实际上，如果只有几十毫安，压降会很小，电流越小，压降越小，所以一般来说实际使用压降会远远小于 0.55V。这又一步的降低了上面说的问题。

**3、应用领域**

如果在单片机系统中，基本上很难达到 3A 电流，不要说我上图的例子是 12V 电源，即便是 5V 入口，常用的方案也不可能达到 3A 电流，接触的领域不同，我所接触的功耗最大的就是 4G 模块，瞬时电流也很少有达到 3A （3.3V）的，换成 5V 主供电也只有 2A 了，还是瞬时电流。所以单片机系统中，一般的方案都不会有那么大的电流。

其他的传感器之类的设备，一般如果真的大功耗，厂家或者产品手册都会特别说明功耗，现在大趋势都是朝着低功耗方向发展的。

> 所以总的来说，在单片机系统中，不管是 12~24V 电源入口，还是 5V 电源入口，即便是使用电池的场合（能够使用电池一般都是低功耗产品，低功耗产品的电流小，二极管的压降会很小），这个电路基本都适用用。
> 
> 但是真的是方案面向工业领域或者大功率领域，上升到那个层次，应该会有更加好的方式。

## 1.2 桥式整流电路

二级管桥式整流电路，使用 4 个二极管，可以使得电源不分正反，如下图（本图就是实际使用过的）：

![](https://static001.geekbang.org/infoq/cf/cf2e16959e79a2fc59180b14b066463e.png)

上面电路可能不太直观，不好看= =！，其实就是下图这种：

![](https://static001.geekbang.org/infoq/60/607b6be08132c50027d6831d6c45fe36.png)

### 电路分析

这个电路分析方式和上面二极管的基本电路是一样的，网上的大多文章说的问题还是此电路压降是基本电路的 2 倍，发热是 2 倍，不实用。

其实我们根据上面对于二极管的基本分析，我们可以使用 4 个肖特基二极管，在单片机系统中使用也不是问题。 但是同样是因为 2 个二极管的压降，不太适用于 5V 供电的场合。

> 在使用 12~24V 电源入口的单片机系统中比较适用，5V 以及更低的电源入口不太适用。

## 二、保险丝和二极管防反接

还是使用二极管，但是我们这次要配合保险丝使用，电路图如下（本图是示意图，在 12V 时候自己没这么用过）：

![](https://static001.geekbang.org/infoq/0d/0d522f730531a0ea94af16df1c507443.png)

### 电路分析

上图使用了肖特基二极管，实际上这里使用普通二极管比较合适，肖特基二极管反向漏电流相对大一些。

这个电路也是很简单的，正确连接二极管截止，电路正常；反接时候，电流通过二极管经过保险丝，整保险丝电阻极地，电流很大，导致保险丝烧坏。

> 本方案相对上面二极管基本电路而言，好处在于没有了二极管的压降，这在 12V 入口电源的系统中倒是无所谓的，但是在 5V 或者电池供电的场合就比较合适了。

> 缺点是接反了保险丝会被烧坏。所以在实际使用时候可以选择自恢复保险丝。

### 实际使用

在实际项目中，我在使用锂电池的产品上使用过这个电路：

![](https://static001.geekbang.org/infoq/00/00b6c2a215490797cb4ac0a71d72f1f3.png)

图中为什么会有 D2，因为是双电源供电，防止其他电源直接加到锂电池的正极，如果是只有电池供电，D2 是可以去掉的，D2 即便不去掉，就等于在 保险丝和二极管防反接 的基础上再加上了一个 二极管防反接的基础电路，也是没有问题的。

## 三、MOS 管防反接

又用到 MOS 管了，MOS 管的基础请参考：

[全面认识MOS管，一篇文章就够了](https://xie.infoq.cn/link?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_42328389%2Farticle%2Fdetails%2F123922558)  

我们已经全面学习过 MOS 管，它导通电阻低，极强的电流处理能力，可以做开关，使得他也能用于电路的防反接应用中。我们下面分别来看一下使用 PMOS 和 NMOS 来实现的防反接电路。

## 3.1 PMOS 电路

PMOS 管接在电源的正极，电路如下图（本图也实际使用过）：

![](https://static001.geekbang.org/infoq/fd/fdb17d9b9fab49c75a9de811c3ae0c5a.png)

### 电路分析

通过 MOS 管的原理和 MOS 管做开关电源切换电路的博文：

[聊聊电源自动切换电路（常用自动切换电路总结）](https://xie.infoq.cn/link?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_42328389%2Farticle%2Fdetails%2F123703862)  

我们很容易理解上面电路的工作方式：

电源正确连接时候：因为 MOS 管的寄生二极管，使得模式管 S 级电压值为 ：VIN - 寄生二极管的压降 G 级下拉到 GND，Vgs < 0，使得 PMOS 正常导通 ...

电源接反时：G 极是高电平，PMOS 管不导通。电路不工作。

使用此电路一般 也需要注意一个参数：MOS 管的 ID(导通电流)。这不管是对 PMOS，还是 NMOS 都需要注意。

有些小的 MOS 管的 ID 并不是很大，比如我常用的 BSS84：

![](https://static001.geekbang.org/infoq/bc/bcce960b2ef650df0b60ddf930b241d1.png)

这就需要根据自己的负载情况选择合适的 MOS 管了，在我的《全面认识 MOS 管》文章中讲过 MOS 管的参数，可以根据手册来选择自己合适的 MOS 管，然后根据电路判断 MOS 管能够达到的 ID 能否满足负载要求：

![](https://static001.geekbang.org/infoq/19/19b23f21302f3374f133e63667ca8085.png)

### 实际使用

在实际使用中，我们往往会有 2 个电阻，就是 GS 之间并联的电阻，和 G 极串联的电阻，一个实际使用的电路图如下：

![](https://static001.geekbang.org/infoq/70/700082fa16dd451ea65df54b7edfc4f4.png)

至于为什么需要这两个电阻，在我的《全面认识 MOS 管》文章中也有过分析，这里我们就不再分析了。

电阻的选择没有标准，但是在这个地方，导通条件 Vgs 的电压需要根据 R1 和 R2 分压计算得来的。要保证你电路导通的 Vgs 所提供的 ID 能够满足负载要求。

> 上面这个实际使用电路导通后，R1、R2 会一直消耗电流，所以我放得比较大，但是其实我认为，在一般单片机防反接的这种场合，即便去掉 R1 也是没问题的，因为在这种场合我用过不带 R1 的电路。

## 3.2 NMOS 电路

NMOS 管接在电源的负极，栅极高电平导通，注意 GS 的方向，寄生二极管应该是反接，即是 NMOS 的 D 极连接至电源入口。

![](https://static001.geekbang.org/infoq/3a/3a968c863faec6f93a45936a1e2f37ef.png)

### 电路分析

NMOS 会破坏地回路,所以其实我基本没用过 = =！

根据我们所学的 MOS 管知识，也可以很好的理解这个电路，但是我们还是简单分析一下：

电源正确连接时候：电压经过 R2、R1，R1 与 R2 分压后其 GS 极电压大于 MOS 导通电压 Vgs（通过寄二极管到电源负极可以形成回路），MOS 导通。

电源接反时：寄生二极管截止，没有回路形成，没有电压，MOS 管不导通。

其他的细节问题和上面的 PMOS 管一致。

> 使用 MOS 管电路防反接，解决了二极管存在的压降问题，但是电路相对二极管来说复杂一些，成本也高一点。

## 结语

本文结合自己的工作经验，聊了聊大家都熟悉的常用防反接电路。

单片机领域，还是二极管最朴实最实用。MOS 管就像好马，需要懂它的伯乐。

但是如果不能够完全理解 MOS 管的原理，用起来没问题还好，出了问题感觉就不是那么回事了，对于 MOS 管的应用，首先要得了解 MOS 管的原理，MOS 管的参数，还是得好好看看一些基础，怕文中的推荐链接小伙伴没看到，再次推荐一下博文：

[全面认识MOS管，一篇文章就够了](https://xie.infoq.cn/link?target=https%3A%2F%2Fblog.csdn.net%2Fweixin_42328389%2Farticle%2Fdetails%2F123922558)  

其实在实际使用中，可以先根据先人给出的经验去设计电路，然后通过实际的测试，分析，最好是踩几次坑，吃几次教训，自己才能真正的设计出越来越稳定可靠的电路。

好了，今天的电路小课堂到这里就结束了，谢谢大家！ 喜欢的朋友多多支持哦！